---
title: 云发布微服务架构和性能
description: 了解新的Microservice如何在AEMaCS上实现可扩展发布。
source-git-commit: 2e45f132ced5ac29118a7301f104bedc03c93253
workflow-type: tm+mt
source-wordcount: '730'
ht-degree: 0%

---


# 云发布微服务架构与性能分析

本文将分享对新云发布微服务的架构和性能编号的分析。

>[!NOTE]
>
> 目前，AEM指南中基于微服务的发布仅支持使用本机PDF发布或通过DITA-OT进行PDF输出。 AEM指南将在未来版本中添加基于微服务的发布支持，以提供更多输出类型。

## 云上现有发布工作流存在的问题

DITA发布是一个资源密集型过程，主要取决于可用系统内存和CPU。 如果发布者发布包含多个主题的大型映射，或者触发多个并行发布请求，则对这些资源的需求会进一步增加。

如果您没有使用新服务，则所有发布都会在同时运行AEM云服务器的同一Kubernetes(k8)面板上进行。 典型的k8面板对其可使用的内存和CPU数量有限。 如果AEM Guides用户正在发布大型或并行工作负载，则此限制可能会快速突破。 K8会重新启动尝试使用的资源超过配置限制的Pod，这些Pod可能会对AEM云实例本身造成严重影响。

此资源限制是我们提供专用服务的主要动机，该服务允许我们在云上运行多个并发和大型发布工作负载。

## 新架构简介

该服务正在使用Adobe的尖端云解决方案（如App Builder、IO Eventing、IMS）来创建无服务器产品。 这些服务本身以Kubernetes和Docker等广为接受的行业标准为基础。

对新发布微服务的每个请求都在隔离的Docker容器中执行，该容器一次只运行一个发布请求。 系统会自动创建多个新容器，以备收到新的发布请求。 这种按请求配置的单个容器使微服务能够为客户提供最佳性能，而不会带来任何安全风险。 发布结束后，这些容器将被丢弃，从而释放任何未使用的资源。

所有这些通信都由Adobe IMS使用基于JWT的身份验证和授权来保护，并通过HTTPS执行。

<img src="assets/architecture.png" alt="项目选项卡" width="600">

>[!NOTE]
>
> 发布过程会在AEM服务器本身上执行请求的某些内容相关部分，如依赖项列表生成。 但是，发布流程中最详尽的部分（如运行DITA-OT或本机引擎）已卸载到新服务中。


## 性能分析

此部分显示微服务的性能编号。 它将微服务的性能与AEM Guides on-prem产品进行比较，因为旧的云架构在并发发布或发布超大型地图时出现问题。

如果您要在内部发布大型映射，则可能必须调整Java堆参数，否则可能会遇到内存不足错误。 在云上，已对微服务进行了配置，并且开箱即可获得最佳Java堆和其他配置。

### 在云上运行一次发布与在内发布

* 云

   如果您使用新服务在云上执行单次发布，则与单次预发布相比，发布可能需要更长时间。 这种短暂的提升时间是由于新云架构的分布式性质所致。

   <img src="assets/cloud_single_publish.png" alt="项目选项卡" width="600">

* 内部部署

   单次发布的结果在旧云架构或内部更好，因为完全发布是在运行AEM的同一个面板/计算机上进行的。

   <img src="assets/onprem_single_publish.png" alt="项目选项卡" width="600">

### 在云上运行多个发布与在前运行

* 云

   在此情景中，新的发布微服务将大放异彩。 如下图所示，随着多个并发发布作业的增加，云能够发布这些作业，而发布时间没有显着增加。

   <img src="assets/cloud_bulk_publish.png" alt="项目选项卡" width="600">

* 内部部署

   在内部服务器上运行并发发布会导致性能严重下降。 如果出版商同时发布更多地图，则性能下降会更严重。

   <img src="assets/onprem_bulk_publish.png" alt="项目选项卡" width="600">

## 其他优势

每个发布请求的某些部分必须在AEM实例上运行，以获取要发送到Microservice的正确发布内容。 新的云架构使用AEM作业代替AEM工作流，与旧架构中的情况类似。 通过这项更改，AEM指南管理员可以单独配置云发布队列设置，而不会影响其他AEM作业或工作流配置。

有关如何配置新发布微服务的详细信息，请访问： [配置微服务](configure-microservices.md)